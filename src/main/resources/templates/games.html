<div class="container">
    <div class="row">
        <!----form begin--->
        <form class="form-filter">
            <div class="col-md-3"> <h2 class="text-center">Producten</h2></div>
            <div class="form-group col-md-3">
                <input id="search" name="search" class="form-control" type="text" placeholder="Search">
                <input id="submitbutton" type="button" value="Submit" onclick="updateTable($('#search').val())">
            </div>
            <div class="form-group col-md-6">

                <label class="col-md-3">Prijs</label>
                <div class="col-md-3">
                </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="pricesort" id="PriceSort-0" value="0" checked="checked">
                            laag naar hoog
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="pricesort" id="PriceSort-1" value="1">hoog naar laag
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="pricesort" id="PriceSort-2" value="2" checked="checked">
                            Geen
                        </label>
                    </div>
                </div>
            <div class="form-group col-md-6">

                <label class="col-md-3">Prijs</label>
                <div class="col-md-3">
                    <div class="radio">
                        <label>
                            <input type="radio" name="platformsort" id="Platformsort-1" value="0" checked="checked">
                            Geen
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="platformsort" id="Platformsort-2" value="1" checked="checked">
                            Playstation
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="platformsort" id="Platformsort-3" value="2">Xbox
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="platformsort" id="Platformsort-4" value="3">PC
                        </label>
                    </div>
                </div>
            </div>
        </form>
        <a href="javascript:history.back()"><button type="button" class="btn btn-default btn-lg"><span class="glyphicon glyphicon-arrow-left"></span> Terug</button></a>
        <!-----form end ---->
    </div>
    <hr>
    <div id="ProductContainer" class="container">

    </div>
</div>

<!---products--->


<!------ End products ----->

<script type="text/javascript">
    var option = "";
    var input = document.querySelector('input[type= text][id = "search"]');

    $(function () {
        $('input[name="pricesort"]').change(function(){ radioClick() });
        radioClick();
        $('input[name="platformsort"]').change(function () { platformClick()});
        platformClick();
        updateTable();
    });

    function radioClick(){
        id = $('input[name="pricesort"]:checked').val();
        if(id == "0") {
            option = "games.games_price";
        }
        else if(id == "1"){
            option = "games.games_price DESC";
        }
        else{
            option = ""
        }
    }
    function platformClick(){
        id = $('input[name="platformsort"]:checked').val();
        if(id == "1") {
            platform = "Playstation";
        }
        else if(id == "2"){
            platform = "Xbox";
        }
        else if(id == "3"){
            platform = "PC"
        }
        else{
            option = ""
        }
    }


    function updateTable(searchAppend) {
        var stdURL = "/games.json";
        var productContainer = $('#ProductContainer');
        if(searchAppend != null){
            getJson(stdURL + "?search=" + searchAppend + "&order=" + option );
        }
        else if (platform != null){
            getJson(stdURL + "?search=" + platform + "&order=" + option);
        }
        else if (option != null) {
            getJson(stdURL + "?order=" + option);
        }
        else{
            getJson(stdURL);
        }
    }

    function getJson(url) {
        console.log(url);
        $.ajax({
            type: 'POST',
            url: url,
            dataType: "json",
            success: filltable,
            error: function () {
                console.log("Incorrect or missing JSON")
            }
        });
    }

    function filltable(data) {
        var json = data;
        var content = [];
        var productContainer = $('#ProductContainer');

        productContainer.empty();
        $.each(json, function (i, item) {
            content = $("<div class='col-md-3 column productbox' id='productbox'>");
            content.append("<div><img id='GamesPageImg' src='" + item.games_image + "'  class='img-responsive'>");
            content.append("<div class='caption'>");
            content.append("<h5 id='game_name'>" + item.games_name + "</h5>");
            content.append("<p>Prijs: " + item.games_price + ",-</p>");
            content.append("<p><a href='/games/bekijken?id="+ item.games_id +"' class='btn btn-success' role='button' id='button1'>Bekijken</a>    <a href='#' class='btn btn-primary role='button'><span class='glyphicon glyphicon-shopping-cart' aria-hidden='true'></span>+ winkelmand</a></p>");
            content.append("</div></div></div>");
            productContainer.append(content);
        })
    }
</script>